from fastapi import FastAPI
from jwcrypto import jwk
import json
import os

app = FastAPI()

PUBLIC_KEY = open(os.getenv("PUBLIC_KEY_PATH")).read()
public_jwk = jwk.JWK.from_pem(PUBLIC_KEY.encode())

@app.get("/jwks.json")
def jwks():
    return {
        "keys": [json.loads(public_jwk.export_public())]
    }
